<xml xmlns="http://www.w3.org/1999/xhtml"><block type="procedures_defnoreturn" id="_,CA|X7pZb*u76:(u~i6" x="776" y="-693"><field name="NAME">ASR_CODE</field><comment pinned="false" h="80" w="160">描述该功能...</comment><statement name="STACK"><block type="block_with_textarea" id="Y][*{?p4~JC@(h_kq{j8"><field name="input">//本函数是语音识别成功钩子程序
//运行时间越短越好，复杂控制启动新线程运行</field><next><block type="block_with_textarea" id="[;Y-r{cZh|7@8;cMICYj"><field name="input">//唤醒时间设置必须在ASR_CODE中才有效</field><next><block type="set_state_enter_wakeup" id="o_iFgGnjoT`?{b^FdB~("><value name="num"><shadow type="math_number" id="pw~TQu+NtH+xQ0=YVosD"><field name="NUM">10</field></shadow></value><next><block type="block_with_textarea" id="c9tHRr0BT;LG.CvJs..k"><field name="input">//用switch分支选择，根据不同的识别成功的ID执行相应动作，点击switch左上齿轮
//可以增加分支项</field><next><block type="controls_if" id="tE2l)XTaBV;;mAVKaF)6"><mutation elseif="10" else="1"></mutation><value name="IF0"><block type="logic_compare" id="c+zHOGr@=0n#wDilWwfI"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="S757:vc2WmG`b,{m-uq;"></block></value><value name="B"><block type="math_number" id="}eBNvJ)@2IwkxH8gi_9W"><field name="NUM">0</field></block></value></block></value><statement name="DO0"><block type="block_with_textarea" id="N1?#GQ49X1-/3P2E[X+("><field name="input">// 播报信息 55   0</field><next><block type="asr_event_serial_print" id="LM0_FpKN`@z?$.^s/umm"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA 55</field></block></next></block></statement><value name="IF1"><block type="logic_compare" id="QN)Yz#@4*Bk91`B~w%Q^"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="Q40?m4M:}zWCo3WkfbDk"></block></value><value name="B"><block type="math_number" id="~?;4E4.$OR^{qIQ#BB6@"><field name="NUM">1</field></block></value></block></value><statement name="DO1"><block type="block_with_textarea" id="B{6eJd6Rnw8BG6bx(jE#"><field name="input">// 询问当前温度 01 1</field><next><block type="asr_event_serial_print" id="s!-T%sjRGyN4s4WmSi]W"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA 01</field></block></next></block></statement><value name="IF2"><block type="logic_compare" id="NL5shK1e7++PEHUUo@:M"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="MEJSG,5e.8c^^I].=+QQ"></block></value><value name="B"><block type="math_number" id="o1-{%t82!nKqt3)_l1w6"><field name="NUM">2</field></block></value></block></value><statement name="DO2"><block type="block_with_textarea" id="j-:M__I/3rpV}XUpzYvr"><field name="input">// 询问当前水量 02 2</field><next><block type="asr_event_serial_print" id="TYW(_NVmpopwg.Ku^K%k"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA 02</field></block></next></block></statement><value name="IF3"><block type="logic_compare" id="7H-{vDW1aZ)F[[F2hT2U"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="[Mjv|3`6OziKu,Wj@hO$"></block></value><value name="B"><block type="math_number" id="_yXb@,U_SBagpq(-:W/H"><field name="NUM">3</field></block></value></block></value><statement name="DO3"><block type="block_with_textarea" id="qbnrfi)y1=i^sB+#VvJ?"><field name="input">// 发送开启提醒命令 30 3</field><next><block type="asr_event_serial_print" id="V;AVP*CP)2`40(S:;uTG"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA 30</field></block></next></block></statement><value name="IF4"><block type="logic_compare" id="cl(J-IOfY3?xukw9EVXV"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="[G]]lgi`K4(oLnrHh7q9"></block></value><value name="B"><block type="math_number" id="DyeF}M{Tr/1qw69_.u#I"><field name="NUM">4</field></block></value></block></value><statement name="DO4"><block type="block_with_textarea" id="audx;)kC[thxiIjToKi/"><field name="input">// 发送关闭提醒命令 30 4</field><next><block type="asr_event_serial_print" id=")rPb)^$~7Ezr~|$qc,{!"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA 31</field></block></next></block></statement><value name="IF5"><block type="logic_compare" id="cub/iJ,=%#izNq%issmK"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="wZX9S#9jNgOk}_.Gm3{B"></block></value><value name="B"><block type="math_number" id="_4IbLzs6AIK}^]jqq)bp"><field name="NUM">5</field></block></value></block></value><statement name="DO5"><block type="block_with_textarea" id="Gfx{6FE^ryP-oi8AijF5"><field name="input">// 显示状态</field><next><block type="asr_event_serial_print" id="(OoNaWquuFahhA(N@L5+"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA 88</field></block></next></block></statement><value name="IF6"><block type="logic_compare" id="s.(JceM^)(F?]tgI^sua"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="j6@zE%%yPHUQ)4]=i1$T"></block></value><value name="B"><block type="math_number" id="mUW~6=|6tNJgv0%DCy{R"><field name="NUM">6</field></block></value></block></value><statement name="DO6"><block type="block_with_textarea" id="F!98lq=h*,WIf/6}#t7T"><field name="input">// 显示数据</field><next><block type="asr_event_serial_print" id="}}/;;=S3*LG^[K]@yZ(G"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA 99</field></block></next></block></statement><value name="IF7"><block type="logic_compare" id="t.U5MmLXGFzshRW~%hj*"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="HL$_uFxh*!o6AsG3If,2"></block></value><value name="B"><block type="math_number" id="yzMq7hKR$ZWsFsJC*^qr"><field name="NUM">7</field></block></value></block></value><statement name="DO7"><block type="block_with_textarea" id=",ZlYv~~;$[CUU5Gw?s10"><field name="input">//测试模式一</field><next><block type="asr_event_play_audio" id="(MICNXTFOLt94hqU4;`I"><field name="audio">此模式会设置水温为 90 度</field><next><block type="asr_event_serial_print" id="vM88%eXpjWg4N[A;NZa/"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA f1</field></block></next></block></next></block></statement><value name="IF8"><block type="logic_compare" id="XB.eOk27(pScOW~P!},0"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="RlAB2f((F/aUY$_#f8}|"></block></value><value name="B"><block type="math_number" id="X.Q(_`kL7dU?9S0:*C?t"><field name="NUM">8</field></block></value></block></value><statement name="DO8"><block type="block_with_textarea" id=":Qel^*AnrEn3`~?n9-BL"><field name="input">//测试模式二</field><next><block type="asr_event_play_audio" id="}zo}x6S0{k@7vpumPSJT"><field name="audio">此模式会设置水温为 10 度</field><next><block type="asr_event_serial_print" id="CRDh[SY,9ANFiFNg/x4u"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA f2</field></block></next></block></next></block></statement><value name="IF9"><block type="logic_compare" id="u;OYKYZ7JBjv$XR`{d)y"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="k9c}ya/pV`lE;i|E2|P]"></block></value><value name="B"><block type="math_number" id="[)p{,mVHEU4FS}gSv[Fz"><field name="NUM">9</field></block></value></block></value><statement name="DO9"><block type="block_with_textarea" id="gEu#z8Z|sjqsVDP*o}fo"><field name="input">//测试模式三</field><next><block type="asr_event_play_audio" id="]UQNah!R=_5ZpIMQs]0S"><field name="audio">此模式会设置 水温为50 水量为百分之 50</field><next><block type="asr_event_serial_print" id="xUy9+krQ+Z|5uB=IibKY"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA f3</field></block></next></block></next></block></statement><value name="IF10"><block type="logic_compare" id=")5n/PT}J[x)2djc2OwZ)"><field name="OP">EQ</field><value name="A"><block type="asr_snid" id="@#dw/i=}[-tIXI6!j;W@"></block></value><value name="B"><block type="math_number" id="PX$Iol[k-c`T}w/li1F0"><field name="NUM">10</field></block></value></block></value><statement name="DO10"><block type="block_with_textarea" id="bgsUtmrA8(0oM2Q)x4?8"><field name="input">//测试模式四</field><next><block type="asr_event_play_audio" id="~5Ref:^X^V`=Xj7)}NYM"><field name="audio">会退出测试模式</field><next><block type="asr_event_serial_print" id="~aox{l.9v,an4E+%Y:x4"><field name="serial_select">Serial2</field><field name="mode">HEX</field><field name="wordwrap">0</field><field name="NAME">00 AA f4</field></block></next></block></next></block></statement><statement name="ELSE"><block type="serial_println" id="^z:Ep$;7*b::Q;VCY{e2"><field name="serial_select">Serial</field><value name="CONTENT"><block type="text" id="S-iq@Cfw%|ITsT,j,nxF"><field name="TEXT">钩子部分未识别到对应的 语音识别 ID</field></block></value></block></statement></block></next></block></next></block></next></block></next></block></statement></block><block type="setup" id="FZ;QNouPm+Ydel/bulm8" x="0" y="0"><statement name="DO"><block type="block_with_textarea" id="66J,7(Nj[CktsTAH?eYT"><field name="input">//需要操作系统启动前初始化的内容</field><next><block type="block_with_textarea" id="xWLiUKfMSmt6$=5z;3T2"><field name="input">//播报音下拉菜单可以选择，合成音量是指TTS生成文件的音量</field><next><block type="asr_speak" id="MaT`9+Oikgn}zKtgg?A["><field name="VOICE_SET">小蝶-清新女声</field><field name="vol">6</field><field name="speed">10</field><next><block type="block_with_textarea" id="2@?n55;2(xS*c`=7,ke0"><field name="input">//欢迎词指开机提示音，可以为空</field><next><block type="asr_event_setup_wakeup" id="f(ZzZmOIKLVF6}QZZ2n?"><field name="mode">2</field><next><block type="asr_welcom" id=")3`e*f)~4i4wI?[QymJY"><field name="NAME">欢迎使用智能茶杯。</field><next><block type="block_with_textarea" id="HJx~+H;YsZH70,LqYXPN"><field name="input">//退出语音是指休眠时提示音，可以为空</field><next><block type="block_with_textarea" id="BkD0VpH-lb;yAtn`gS$+"><field name="input">//休眠后用唤醒词唤醒后才能执行命令，唤醒词最多5个。回复语可以空。ID范围为0-9999</field></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="thread_app" id="VbwL1j$+cg,a+AAUMhBS" x="-122" y="699"><field name="app_name">REC</field><field name="uxPriority">1</field><field name="mem">512</field><statement name="DO"><block type="controls_repeat_forever" id="}LsmSYS0x%$]_:321axE"><statement name="DO"><block type="controls_if" id="b[Dxg.:#pOsKF#snU+.v"><mutation else="1"></mutation><value name="IF0"><block type="serial_available" id="sV4z/OV]#?Z~-|tRR$P3"><field name="serial_select">Serial2</field></block></value><statement name="DO0"><block type="block_with_textarea" id="L$uF2vxiX;%Z4~.W*p^r"><field name="input">//串口接收字符串必须临时声明字符串变量，如下所示</field><next><block type="variables_declare" id="p/SQf#?OP8BkS[VDW_%("><field name="VAR">Res</field><field name="ioinput">String</field><value name="VALUE"><block type="text" id="oIj,Mc/CsXm1SfC.uD]8"><field name="TEXT"></field></block></value><next><block type="variables_set" id="a]21v1DJ2yg/OtZ20b1d"><field name="VAR">Res</field><value name="VALUE"><block type="serial_readstr" id="`|t~hs{Cw-k=kFN}7,HT"><field name="serial_select">Serial2</field></block></value><next><block type="serial_println" id="!99{CnZ*)R|V`Id`Qz(b"><field name="serial_select">Serial</field><value name="CONTENT"><block type="variables_get" id="WRsN8]T4Ec2*/-roezp{"><field name="VAR">Res</field></block></value><next><block type="controls_if" id=")%Q)}LzhNecUe7@z{:_7"><mutation else="1"></mutation><value name="IF0"><block type="logic_operation" id="UjEU+~h9L;.)o[sL`fy1"><field name="OP">AND</field><value name="A"><block type="logic_compare" id="si2!0Q!p3-4Lwa]dPSWc"><field name="OP">EQ</field><value name="A"><block type="c51_get_any" id="A)xTJBi`8koq7aYub?!l"><field name="NAME">(uint8_t)Res[0]</field></block></value><value name="B"><block type="math_number" id="E*36)?Poe.U|AVLl6Zdw"><field name="NUM">0xAA</field></block></value></block></value><value name="B"><block type="logic_compare" id="pw]FUZ4(aZt|L`KKmt7v"><field name="OP">EQ</field><value name="A"><block type="c51_get_any" id="!tfuANFvQPD-%4L(mmOS"><field name="NAME">(uint8_t)Res[1]</field></block></value><value name="B"><block type="math_number" id="N6]}ft$.kx]OjmfNtWX*"><field name="NUM">0x00</field></block></value></block></value></block></value><statement name="DO0"><block type="controls_if" id="vh1[VJ}i:B11zgJoMcPO"><mutation elseif="4" else="1"></mutation><value name="IF0"><block type="logic_compare" id="tu.WaR#8EUJ6!yB%Ai`5"><field name="OP">EQ</field><value name="A"><block type="c51_get_any" id="fUf=,Sb]H761=#~J/|w_"><field name="NAME">(uint8_t)Res[2]</field></block></value><value name="B"><block type="math_number" id="GX^*U$Is)b3JNC0^szv+"><field name="NUM">0xF1</field></block></value></block></value><statement name="DO0"><block type="serial_println" id="1q!uZ`:7+S$Zbm}/X9#`"><field name="serial_select">Serial</field><value name="CONTENT"><block type="text" id="Evy2{5aPYRZJM!W=8Xao"><field name="TEXT">光线太暗进行补光播报</field></block></value><next><block type="block_with_textarea" id="qmf4dw.H^MB#.Z!9}byB"><field name="input">//光线太暗进行补光播报</field><next><block type="asr_event_play_audio" id="gvBn(a{9t/nsyA*z2-Cm"><field name="audio">主人 环境光太暗了 会伤眼睛哦</field></block></next></block></next></block></statement><value name="IF1"><block type="logic_compare" id="sD0FUr:~n|7ymGr[i=29"><field name="OP">EQ</field><value name="A"><block type="c51_get_any" id="06Hd;+,z8ckR,lHG3X24"><field name="NAME">(uint8_t)Res[2]</field></block></value><value name="B"><block type="math_number" id="yKe3.P9*pIL;IsqK%Qba"><field name="NUM">0xF2</field></block></value></block></value><statement name="DO1"><block type="block_with_textarea" id="*=+s_Ff`.Fzf6OccI}0U" disabled="true"><field name="input">//坐姿提醒语音播报</field><next><block type="asr_event_play_audio" id="ZU6/[sD:rKs_8~eR7L?M"><field name="audio">主人 环境光太暗了 会伤眼睛哦</field></block></next></block></statement><value name="IF2"><block type="logic_compare" id="7k`+[$^Q(s=/g([ar=*f"><field name="OP">EQ</field><value name="A"><block type="c51_get_any" id="8dxZ!9ePo+u$8?v6HZdb"><field name="NAME">(uint8_t)Res[2]</field></block></value><value name="B"><block type="math_number" id="^bFTPjoY,FsyLGyftdqJ"><field name="NUM">0xF3</field></block></value></block></value><value name="IF3"><block type="logic_compare" id="OJ|?Thl).{@)F:V2*lJ$"><field name="OP">EQ</field><value name="A"><block type="c51_get_any" id="qE{O?hbm0GIAan%$aMpy"><field name="NAME">(uint8_t)Res[2]</field></block></value><value name="B"><block type="math_number" id="Oq#vz,Wqr_G?rFE@8dAk"><field name="NUM">0xF4</field></block></value></block></value><statement name="ELSE"><block type="serial_println" id="@i,WHdAt6;8l?w~+pA*D"><field name="serial_select">Serial</field><value name="CONTENT"><block type="text" id="|c(|w%lCm9kUJ~*bIjlq"><field name="TEXT">线程部分 未成功解析到 第三个字节对应的数据包</field></block></value></block></statement></block></statement><statement name="ELSE"><block type="serial_println" id="n@y%MCTs-zWQH4%bg*VL"><field name="serial_select">Serial</field><value name="CONTENT"><block type="text" id=":Quw.DZ=It=d6Yqf[u8?"><field name="TEXT">线程部分 串口有数据 但是前两个字节 不是对应的数据</field></block></value></block></statement></block></next></block></next></block></next></block></next></block></statement><next><block type="haodabit_DELAY1" id="?9GLKVrV=cOquDzNEOVk"><value name="ioinput"><shadow type="math_number" id="1{~[3`U#Nl3:j-^_wpj}"><field name="NUM">2</field></shadow></value></block></next></block></statement></block></statement></block><block type="block_with_textarea" id="k~NNEy=zQ9G?G){tFC(S" disabled="true" x="450" y="1005"><field name="input">//学习时间已满提醒</field></block><block type="block_with_textarea" id="/Im[u[9b6N0hRl#O$~P(" disabled="true" x="545" y="1122"><field name="input">//休息时间已满提醒</field></block><block type="asr_event_play_audio" id="*cuZnPlBr)[BYhG-+]4o" disabled="true" x="370" y="1183"><field name="audio">主人请保持做正确的坐姿哦</field></block><block type="asr_event_play_audio" id="x0ya#SH^N`Ld2?:2we$-" disabled="true" x="426" y="1242"><field name="audio">主人已经休息的有一会了呢 该学习了</field></block><block type="asr_event_play_audio" id="}F$:@BipG/zV?Hf]TT1%" disabled="true" x="266" y="1701"><field name="audio">线程部分 未成功解析到 第三个字节对应的数据包</field></block><block type="asr_event_play_audio" id=";J=fBrMmM]^LbJVZZw37" disabled="true" x="143" y="1785"><field name="audio">线程部分 串口有数据 但是前两个字节 不是对应的数据</field></block><block type="hardware_init" id="5(xjiHKGxzSO7.q~)ub2" x="0" y="3355"><statement name="DO"><block type="vol_set" id="]7/`yuVo}+2PuukIy2,8"><value name="num"><shadow type="asr_vol" id="t9hY@q#b_2CO_3/_Z1u#"><field name="PIN">4</field></shadow></value><next><block type="serial_begin" id="O61o$QXN(cSiPG1p:*VD"><field name="serial_select">Serial2</field><field name="TX">PA_5</field><field name="RX">PA_6</field><value name="CONTENT"><shadow type="baud" id="y(NefMcmoJ%fjDWV;*N0"><field name="baud">9600</field></shadow></value><next><block type="serial_begin" id="Y0=g4;)t4QnnvXs{A2^c"><field name="serial_select">Serial</field><field name="TX">PB_5</field><field name="RX">PB_6</field><value name="CONTENT"><shadow type="baud" id="%)]KJ#,~/hnSA2o]|3gC"><field name="baud">9600</field></shadow></value><next><block type="block_with_define" id="ti72bWrtwV`Udh6|H:%t"><field name="NAME">ASRPRO_CMD_Broadcast_information   0x55  // 语音模块收到需要播报信息的命令</field><next><block type="block_with_define" id="h}e*xVB8Lfl/]:PIhZ(E"><field name="NAME">ASRPRO_CMD_Query_Temperature       0x01  // 查询水温命令</field><next><block type="block_with_define" id="@lP?6{O)YK]IUS,Y)}95"><field name="NAME"> ASRPRO_CMD_Query_WaterLevel        0x02  // 查询水量命令</field><next><block type="block_with_define" id="v/UiSr5(Hea2yDmn_89t"><field name="NAME">ASRPRO_CMD_Query_Status            0x03  // 查询水杯状态命令</field><next><block type="block_with_define" id="3;arOaU`km?6lqn]1gGw"><field name="NAME">ASRPRO_CMD_Disable_Reminder        0x31  // 关闭喝水提醒命令</field><next><block type="block_with_define" id="4+s#qf.IKBGV|~rbiPw%"><field name="NAME">ASRPRO_CMD_Broadcast_information   0x55  // 语音模块收到需要播报信息的命令</field><next><block type="block_with_define" id="gkP+n=_i9z^vb^%i+)#("><field name="NAME">ASRPRO_CMD_Broadcast_information   0x55  // 语音模块收到需要播报信息的命令</field><next><block type="block_with_define" id="x^l`uI+3m.X^_[n1H^Xw"><field name="NAME">ASRPRO_CMD_Broadcast_information   0x55  // 语音模块收到需要播报信息的命令</field><next><block type="block_with_define" id="BIsBac[n+yOM/ydmKd6l"><field name="NAME">ASRPRO_CMD_Broadcast_information   0x55  // 语音模块收到需要播报信息的命令</field><next><block type="block_with_define" id="hQ}1{VBaFUxB$$tL|v+1"><field name="NAME">ASRPRO_CMD_Broadcast_information   0x55  // 语音模块收到需要播报信息的命令</field></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="block_with_textarea" id="in-LMn4]o0jz`@s/fQl#" x="0" y="3793"><field name="input">// #define ASRPRO_CMD_Broadcast_information   0x55  // 语音模块收到需要播报信息的命令
// #define ASRPRO_CMD_Query_Temperature       0x01  // 查询水温命令
// #define ASRPRO_CMD_Query_WaterLevel        0x02  // 查询水量命令
// #define ASRPRO_CMD_Query_Status            0x03  // 查询水杯状态命令
// #define ASRPRO_CMD_Enable_Heating          0x10  // 开启加热命令
// #define ASRPRO_CMD_Disable_Heating         0x11  // 关闭加热命令
// #define ASRPRO_CMD_Open_CupLid             0x20  // 打开杯盖命令
// #define ASRPRO_CMD_Close_CupLid            0x21  // 关闭杯盖命令
// #define ASRPRO_CMD_Enable_Reminder         0x30  // 开启喝水提醒命令
// #define ASRPRO_CMD_Disable_Reminder        0x31  // 关闭喝水提醒命令
// #define ASRPRO_CMD_Restore_Default         0x40  // 恢复默认设置命令
// #define ASRPRO_CMD_Auto_Broadcast          0x50  // 自动播报温水适宜命令
// #define ASRPRO_CMD_Low_Water_Alert         0x51  // 自动播报水量不足命令</field></block></xml>
<!-- edittype="asr_pro" -->
<!-- officialLib="[]" -->
<!-- personalLib="[]" -->